@model IEnumerable<ClienteJuridicoView>
@using Era_sphere.Areas.AreaClientes.Models
@using Era_sphere.Generics;
@using Telerik.Web.Mvc.UI
@{
    ViewBag.Title = "ClienteJuridicoIndexView";
    var paises = (new EraSphereContext()).paises.ToList();
    var ciudades = (new EraSphereContext()).ciudades.ToList();
    var estados = (new EraSphereContext()).estados_cliente.ToList();
}
<script src="@Url.Content("~/Scripts/jquery.validate.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.validate.unobtrusive.min.js")" type="text/javascript"></script>

@(Html.Telerik().Grid(Model)
        .Name("ClienteJuridicoGrid")
        .Localizable("es-ES")
        .Filterable()
        .ToolBar(commands => commands.Insert())
        .Editable(editing => editing
                            .Mode(GridEditMode.PopUp)
                            .TemplateName("ClienteJuridicoViewTemplate"))

        .DataKeys(key => key.Add(c => c.ID))
        .Columns(columns =>
        {
            columns.Bound(p => p.ID);
            columns.Bound(p => p.razon_social);
            columns.Bound(p => p.ruc);
            columns.ForeignKey(p => p.id_estado, new SelectList(estados, "ID", "descripcion"));
            columns.Command(commands =>
            {
                commands.Edit().ButtonType(GridButtonType.Image);
                commands.Delete().ButtonType(GridButtonType.Image);
                commands.Custom("mostrar_juridico").Text("Mostrar").
                    DataRouteValues(route => route.Add(o => o.ID).RouteKey("id")).Ajax(true).Action("MostrarJuridico", "Cliente");

            }).Width(160);
        })

        .Pageable()
        .Sortable()

        .ClientEvents(events => events.OnComplete("onComplete"))
        .DataBinding(dataBinding => dataBinding
            .Ajax().Select("_CustomCommand", "Cliente")
            .Select("SelectJuridico", "Cliente")
            .Insert("InsertJuridico", "Cliente")
            .Delete("DeleteJuridico", "Cliente")
            .Update("UpdateJuridico", "Cliente")
        )
           )

           
@(Html.Telerik().Window()
    .Name("DetalleJuridico").Visible(false).Title("Detalle del cliente").Modal(true).Width(500).LoadContentFrom("ClienteJuridicoShow", "Cliente"))

<script type="text/javascript">
    function onComplete(e) {
        if (e.name == "mostrar_juridico") {
            var detailModal = $("#DetalleJuridico").data("tWindow");
            var cliente = e.response.cliente;
            $("#detalle-cliente-juridico")
            .find("#_razon_social").val(cliente.razon_social).end()
            .find("#_ruc").val(cliente.ruc).end()
            .find("#_telefono").val(cliente.telefono).end()
            .find("#_celular").val(cliente.celular).end()
            .find("#_direccion").val(cliente.direccion).end()
            .find("#_correo_electronico").val(cliente.correo_electronico).end()
            .find("#_numero_reservas").val(cliente.numero_reservas).end()
            .find("#_usuario").val(cliente.usuario).end()
            .find("#_tarjeta_cliente").val(cliente.tarjeta_cliente).end()
            .find("#_paisID").val(e.response.pais).end()
            .find("#_id_estado").val(e.response.estado).end()
            .find("#_ciudadID").val(e.response.ciudad).end()
            detailModal.center().open();
        } else if (e.name == "mostrar_natural") {
            var detailModal = $("#DetalleNatural").data("tWindow");
            var cliente = e.response.cliente;
            $("#detalle-cliente-juridico")
            .find("#_nombre").val(cliente.nombre).end()
            .find("#_apellido_paterno").val(cliente.apellido_paterno).end()
            .find("#_apellido_materno").val(cliente.apellido_materno).end()
            .find("#_ruc").val(cliente.ruc).end()
            .find("#_telefono").val(cliente.telefono).end()
            .find("#_celular").val(cliente.celular).end()
            .find("#_direccion").val(cliente.direccion).end()
            .find("#_correo_electronico").val(cliente.correo_electronico).end()
            .find("#_id_habitacion").val(cliente.id_habitacion).end()
            .find("#_usuario").val(cliente.usuario).end()
            .find("#_tarjeta_cliente").val(cliente.tarjeta_cliente).end()
            .find("#_paisID").val(e.response.pais).end()
            .find("#_id_estado").val(e.response.estado).end()
            .find("#_ciudadID").val(e.response.ciudad).end()
            detailModal.center().open();
        }
    }
</script>
